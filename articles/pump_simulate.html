<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Demo of simulating multi-level data • PUMP</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Demo of simulating multi-level data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PUMP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/pump_demo.html">Demonstration of the PUMP package</a></li>
    <li><a class="dropdown-item" href="../articles/pump_sample_demo.html">Demo and discussion of the pump_sample method</a></li>
    <li><a class="dropdown-item" href="../articles/pump_simulate.html">Demo of simulating multi-level data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MDRCNY/PUMP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Demo of simulating multi-level data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MDRCNY/PUMP/blob/main/vignettes/pump_simulate.Rmd" class="external-link"><code>vignettes/pump_simulate.Rmd</code></a></small>
      <div class="d-none name"><code>pump_simulate.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="purpose-of-this-vignette">Purpose of this vignette<a class="anchor" aria-label="anchor" href="#purpose-of-this-vignette"></a>
</h2>
<p>The main purpose of PUMP is to estimate power, MDES, and sample size
requirements. As a separate task, PUMP provides extra functions that
allow a user to generate data that simulates multi-level RCTs. These
functions may not be relevant for most users, but we provide them for
users who may find it useful. This vignette documents how to use these
simulation functions.</p>
<p>Overall, these simulation functions can be used in two ways: the user
can supply a design just as they do with the power calculation tools,
or, if they want more direct control, they can supply the data
generating parameters directly, including some parameters not used by
the power tools.</p>
<p>The simulation function generates data from a multilevel model with
random intercepts and impacts at each level. In our parlance, for
two-level data we would use <code>m2rr</code>, and for three-level,
<code>m3rr2rr</code>. For single-level data, no random effects are
needed, and the treatment is assumed constant across all units.</p>
</div>
<div class="section level2">
<h2 id="generating-data">Generating data<a class="anchor" aria-label="anchor" href="#generating-data"></a>
</h2>
<p>If you have a PUMP power result, you can generate data representing
that design:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pump_power.html">pump_power</a></span><span class="op">(</span> <span class="st">"d3.1_m3rr2rr"</span>, MDES <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>                  M <span class="op">=</span> <span class="fl">5</span>, rho <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>                  MTP <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>                  nbar <span class="op">=</span> <span class="fl">30</span>, J <span class="op">=</span> <span class="fl">7</span>, K <span class="op">=</span> <span class="fl">5</span>, Tbar <span class="op">=</span> <span class="fl">0.5</span> <span class="op">)</span></span>
<span><span class="va">sim.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_sim_data.html">gen_sim_data</a></span><span class="op">(</span> <span class="va">pp</span> <span class="op">)</span></span></code></pre></div>
<p>The final output is a list of overlapping datasets, one for each
outcome. In the above, for example, we would have three datasets. Here
is the first:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span> <span class="va">sim.data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          V.k       X.jk      C.ijk S.id D.id         Yobs T.x</span></span>
<span><span class="co">## 1 -0.9819827 -0.2346151 -0.1619480    1    1  2.422388557   0</span></span>
<span><span class="co">## 2 -0.9819827 -0.2346151 -0.5228986    1    1 -0.397160508   1</span></span>
<span><span class="co">## 3 -0.9819827 -0.2346151  0.2764065    1    1  0.009688753   0</span></span>
<span><span class="co">## 4 -0.9819827 -0.2346151 -0.7808425    1    1  0.324631103   1</span></span>
<span><span class="co">## 5 -0.9819827 -0.2346151  1.9317788    1    1 -0.710576241   1</span></span>
<span><span class="co">## 6 -0.9819827 -0.2346151  2.1276960    1    1 -0.450927096   0</span></span></code></pre>
<p>We have the observed outcome (<code>Yobs</code>), District and School
ID (<code>D.id</code>, <code>S.id</code>), the level 1, level 2, and
level 3 covariates (<code>C.ijk</code>, <code>X.jk</code>, and
<code>V.k</code>), and treatment assigment (<code>T.x</code>). The
treatment assignment vector is shared across the different outcome
datasets.</p>
<div class="section level3">
<h3 id="generating-for-single-outcome">Generating for single outcome<a class="anchor" aria-label="anchor" href="#generating-for-single-outcome"></a>
</h3>
<p>If you want only one outcome, then you just get a dataframe back,
rather than a list:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pp.one</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span> <span class="va">pp</span>, M <span class="op">=</span> <span class="fl">1</span> <span class="op">)</span></span>
<span><span class="va">sim3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_sim_data.html">gen_sim_data</a></span><span class="op">(</span> <span class="va">pp.one</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span> <span class="va">sim3</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         V.k     X.jk       C.ijk S.id D.id       Yobs T.x</span></span>
<span><span class="co">## 1 0.3608898 1.048434 -0.52190565    1    1  0.4545076   0</span></span>
<span><span class="co">## 2 0.3608898 1.048434 -0.17679558    1    1  1.5032026   0</span></span>
<span><span class="co">## 3 0.3608898 1.048434 -0.03913424    1    1  1.1670284   1</span></span>
<span><span class="co">## 4 0.3608898 1.048434  0.15895222    1    1 -0.7255679   1</span></span>
<span><span class="co">## 5 0.3608898 1.048434 -0.01656836    1    1  1.0229475   0</span></span>
<span><span class="co">## 6 0.3608898 1.048434 -0.07488324    1    1  1.2134919   1</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="getting-components-separately">Getting components separately<a class="anchor" aria-label="anchor" href="#getting-components-separately"></a>
</h3>
<p>Alternatively, <code><a href="../reference/gen_sim_data.html">gen_sim_data()</a></code> can be called to provide
data separated by part:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim.data.v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_sim_data.html">gen_sim_data</a></span><span class="op">(</span> <span class="va">pp</span>, return.as.dataframe <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span> <span class="va">sim.data.v2</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Y0"    "Y1"    "V.k"   "X.jk"  "C.ijk" "ID"    "T.x"   "Yobs"</span></span></code></pre>
<p>Now the simulation output contains a list of the following
vectors:</p>
<ul>
<li>potential outcomes <code>Y0</code> and <code>Y1</code>. These will
be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
columns, one for each outcome.</li>
<li>observed outcomes <code>Yobs</code>. Again
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
columns.</li>
<li>treatment assignment <code>T.x</code>. A numeric vector.</li>
<li>covariates at each level: level 3 <code>V.k</code>, level 2
<code>X.jk</code>, level 1 <code>C.ijk</code>. Each will be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
columns.</li>
<li>ID, matrix of the assignments at each level, with level 2
<code>S.id</code> and level 3 <code>D.id</code>. This is a two column
data.frame</li>
</ul>
<p>Note that these simulated data contains both observed parameters and
unobserved parameters (the unobserved potential outcome, depending on
treatment assignment).</p>
</div>
</div>
<div class="section level2">
<h2 id="choosing-parameter-values">Choosing parameter values<a class="anchor" aria-label="anchor" href="#choosing-parameter-values"></a>
</h2>
<p>The user can also directly set parameter values that will inform the
data generating process. Some of these parameters directly influence
power, while others are “nuisance” parameters that are nevertheless
needed to generate a full dataset. For full explanations of parameters,
see the Technical Appendix.</p>
<p>The minimum set of parameters the user can provide are as
follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.params.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  M <span class="op">=</span> <span class="fl">3</span>                             <span class="co"># number of outcomes</span></span>
<span>  , J <span class="op">=</span> <span class="fl">7</span>                           <span class="co"># number of schools</span></span>
<span>  , K <span class="op">=</span> <span class="fl">5</span>                           <span class="co"># number of districts</span></span>
<span>                                    <span class="co"># (for two-level model, set K = 1)</span></span>
<span>  , nbar <span class="op">=</span> <span class="fl">30</span>                       <span class="co"># number of individuals per school</span></span>
<span>  , rho.default <span class="op">=</span> <span class="fl">0.5</span>               <span class="co"># default rho value (optional)</span></span>
<span>  <span class="co">################################################## impact</span></span>
<span>  , MDES <span class="op">=</span> <span class="fl">0.125</span>                    <span class="co"># minimum detectable effect size      </span></span>
<span>  <span class="co">################################################## level 3: districts</span></span>
<span>  , R2.3 <span class="op">=</span> <span class="fl">0.1</span>                      <span class="co"># percent of district variation</span></span>
<span>                                      <span class="co"># explained by district covariates</span></span>
<span>  , ICC.3 <span class="op">=</span> <span class="fl">0.2</span>                     <span class="co"># district intraclass correlation</span></span>
<span>  , omega.3 <span class="op">=</span> <span class="fl">0.1</span>                   <span class="co"># ratio of district effect size variability</span></span>
<span>                                      <span class="co"># to random effects variability</span></span>
<span>  <span class="co">################################################## level 2: schools</span></span>
<span>  , R2.2 <span class="op">=</span> <span class="fl">0.1</span>                      <span class="co"># percent of school variation</span></span>
<span>                                    <span class="co"># explained by school covariates</span></span>
<span>  , ICC.2 <span class="op">=</span> <span class="fl">0.2</span>                     <span class="co"># school intraclass correlation </span></span>
<span>  , omega.2 <span class="op">=</span> <span class="fl">0.1</span>                   <span class="co"># ratio of school effect size variability</span></span>
<span>                                      <span class="co"># to random effects variability</span></span>
<span>  <span class="co">################################################## level 1: individuals</span></span>
<span>  , R2.1 <span class="op">=</span> <span class="fl">0.1</span>                      <span class="co"># percent of indiv variation explained</span></span>
<span>                                      <span class="co"># by indiv covariates</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The user can also make additional choices that influence the
simulated dat. A couple of notes about possible choices:</p>
<ul>
<li>By default, the function will generate a vector of school and
district assignments S.id and D.id that are evenly split, e.g. with an
equal number of schools in each district and an equal number of students
in each school. However, the user can also provide their own vector of
assignments if they require a specific setup.</li>
<li>If the user specifies a <code>rho.default</code> value, all matrices
will be populated using the assumed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>.
The user can instead provide their own
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
matrices.</li>
</ul>
<p>The full set of parameters the user can specify is below.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">rho.default</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">default.rho.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_corr_matrix.html">gen_corr_matrix</a></span><span class="op">(</span>M <span class="op">=</span> <span class="va">M</span>, rho.scalar <span class="op">=</span> <span class="va">rho.default</span><span class="op">)</span></span>
<span><span class="va">default.kappa.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">M</span>, <span class="va">M</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">model.params.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  M <span class="op">=</span> <span class="fl">3</span>                             <span class="co"># number of outcomes</span></span>
<span>  , J <span class="op">=</span> <span class="fl">7</span>                           <span class="co"># number of schools</span></span>
<span>  , K <span class="op">=</span> <span class="fl">5</span>                           <span class="co"># number of districts</span></span>
<span>                                    <span class="co"># (for two-level model, set K = 1)</span></span>
<span>  , nbar <span class="op">=</span> <span class="fl">30</span>                       <span class="co"># number of individuals per school</span></span>
<span>  , S.id <span class="op">=</span> <span class="cn">NULL</span>                     <span class="co"># N-length vector of school assignments</span></span>
<span>  , D.id <span class="op">=</span> <span class="cn">NULL</span>                     <span class="co"># N-length vector of district assignments</span></span>
<span>  <span class="co">################################################## grand mean outcome and impact</span></span>
<span>  , Xi0 <span class="op">=</span> <span class="fl">0</span>                         <span class="co"># scalar grand mean outcome under no treatment</span></span>
<span>  , MDES <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.125</span>, <span class="va">M</span><span class="op">)</span>            <span class="co"># minimum detectable effect size      </span></span>
<span>  <span class="co">################################################## level 3: districts</span></span>
<span>  , R2.3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="va">M</span><span class="op">)</span>              <span class="co"># percent of district variation</span></span>
<span>                                      <span class="co"># explained by district covariates</span></span>
<span>  , rho.V <span class="op">=</span> <span class="va">default.rho.matrix</span>      <span class="co"># MxM correlation matrix of district covariates</span></span>
<span>  , ICC.3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="va">M</span><span class="op">)</span>             <span class="co"># district intraclass correlation</span></span>
<span>  , omega.3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="va">M</span><span class="op">)</span>           <span class="co"># ratio of district effect size variability</span></span>
<span>                                      <span class="co"># to random effects variability</span></span>
<span>  , rho.w0 <span class="op">=</span> <span class="va">default.rho.matrix</span>     <span class="co"># MxM matrix of correlations for district random effects</span></span>
<span>  , rho.w1 <span class="op">=</span> <span class="va">default.rho.matrix</span>     <span class="co"># MxM matrix of correlations for district impacts</span></span>
<span>  , kappa.w <span class="op">=</span>  <span class="va">default.kappa.matrix</span> <span class="co"># MxM matrix of correlations between district</span></span>
<span>                                      <span class="co"># random effects and impacts</span></span>
<span>  <span class="co">################################################## level 2: schools</span></span>
<span>  , R2.2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="va">M</span><span class="op">)</span>              <span class="co"># percent of school variation</span></span>
<span>                                      <span class="co"># explained by school covariates</span></span>
<span>  , rho.X <span class="op">=</span> <span class="va">default.rho.matrix</span>      <span class="co"># MxM correlation matrix of school covariates</span></span>
<span>  , ICC.2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="va">M</span><span class="op">)</span>             <span class="co"># school intraclass correlation </span></span>
<span>  , omega.2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="va">M</span><span class="op">)</span>           <span class="co"># ratio of school effect size variability</span></span>
<span>                                      <span class="co"># to random effects variability</span></span>
<span>  , rho.u0 <span class="op">=</span> <span class="va">default.rho.matrix</span>     <span class="co"># MxM matrix of correlations for school random effects</span></span>
<span>  , rho.u1 <span class="op">=</span> <span class="va">default.rho.matrix</span>     <span class="co"># MxM matrix of correlations for school impacts</span></span>
<span>  , kappa.u <span class="op">=</span> <span class="va">default.kappa.matrix</span>  <span class="co"># MxM matrix of correlations between school</span></span>
<span>                                      <span class="co"># random effects and impacts</span></span>
<span>  <span class="co">################################################## level 1: individuals</span></span>
<span>  , R2.1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="va">M</span><span class="op">)</span>              <span class="co"># percent of indiv variation explained</span></span>
<span>                                      <span class="co"># by indiv covariates</span></span>
<span>  , rho.C <span class="op">=</span> <span class="va">default.rho.matrix</span>      <span class="co"># MxM correlation matrix of individual covariates</span></span>
<span>  , rho.r <span class="op">=</span> <span class="va">default.rho.matrix</span>      <span class="co"># MxM matrix of correlations for individual residuals </span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Once the user has chosen the model parameters, the only remaining
choice is <code>Tbar</code>, the proportion of units assigned to the
treatment. This parameter is not considered a modeling parameter as it
instead informs the randomization process. It is not passed as part of
the <code>model.params.list</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_sim_data.html">gen_sim_data</a></span><span class="op">(</span>d_m <span class="op">=</span> <span class="st">'d3.3_m3rc2rc'</span>, <span class="va">model.params.list</span>, Tbar <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulation-process">Simulation process<a class="anchor" aria-label="anchor" href="#simulation-process"></a>
</h2>
<p>We briefly walk through the steps conducted by the
<code>gen_sim_data</code> function in case the user wants to inspect
intermediate steps of the process.</p>
<p>First, the user-given parameters are converted into parameters that
inform the data-generating process (DGP). For example, a certain value
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
is converted in a coefficient value.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dgp.params.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_params.html">convert_params</a></span><span class="op">(</span><span class="va">model.params.list</span><span class="op">)</span></span></code></pre></div>
<p>Next, we generate a set of full simulation data, but without assuming
any treatment assignment has occurred. The simulated data includes both
unobserved and unobserved quantities, such as both potential
outcomes.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_base_sim_data.html">gen_base_sim_data</a></span><span class="op">(</span><span class="va">dgp.params.list</span>, </span>
<span>                              dgp.params <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              return.as.dataframe <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">)</span></span></code></pre></div>
<p>Finally, we generate the treatment assignment, and the observed
outcomes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Y</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msup><annotation encoding="application/x-tex">Y^{obs}</annotation></semantics></math>.
At this point, we need to specify the design and <code>Tbar</code> to
generate the correct treatment assignment.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_m</span> <span class="op">&lt;-</span> <span class="st">'d3.3_m3rc2rc'</span></span>
<span><span class="va">sim.data</span><span class="op">$</span><span class="va">T.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_T.x.html">gen_T.x</a></span><span class="op">(</span></span>
<span>    d_m <span class="op">=</span> <span class="va">d_m</span>,</span>
<span>    S.id <span class="op">=</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">ID</span><span class="op">$</span><span class="va">S.id</span>,</span>
<span>    D.id <span class="op">=</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">ID</span><span class="op">$</span><span class="va">D.id</span>,</span>
<span>    Tbar <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sim.data</span><span class="op">$</span><span class="va">Yobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_Yobs.html">gen_Yobs</a></span><span class="op">(</span><span class="va">sim.data</span>, T.x <span class="op">=</span> <span class="va">sim.data</span><span class="op">$</span><span class="va">T.x</span><span class="op">)</span></span></code></pre></div>
<p>Finally, this can be converted to a series of dataframes:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim.data</span> <span class="op">&lt;-</span> <span class="fu">PUMP</span><span class="fu">:::</span><span class="fu"><a href="../reference/makelist_samp.html">makelist_samp</a></span><span class="op">(</span> <span class="va">sim.data</span> <span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luke Miratrix, Kristen Hunter, Zarni Htet, Kristin Porter, Institute of Education Sciences.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
